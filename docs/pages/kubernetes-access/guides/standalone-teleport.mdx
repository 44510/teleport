---
title: Kubernetes Access from standalone Teleport
description: Connecting standalone Teleport installations to Kubernetes clusters.
---

## Standalone Teleport installation

Teleport can connect to external Kubernetes clusters without using the Teleport Helm chart or running a pod inside of the Kubernetes cluster. To do this, Teleport needs a `kubeconfig` file to authenticate against the Kubernetes API.

(!docs/pages/includes/permission-warning.mdx!)

## Generating kubeconfig

First, configure your local `kubectl` command to point at the Kubernetes
cluster you want to register. You can use `kubectl config get-contexts` to
verify that the correct cluster is selected, or `kubectl config use-context
${CONTEXT_NAME?}` to switch to cluster `CONTEXT_NAME`.

Next, use [get-kubeconfig.sh](https://github.com/gravitational/teleport/blob/master/examples/k8s-auth/get-kubeconfig.sh) to create a `kubeconfig` for Teleport to use. This will create:
- The `teleport` namespace
- The `teleport-sa` service account
- The `teleport-role` cluster role
- The `teleport-crb` cluster role binding

You can connect multiple Kubernetes clusters to Teleport from one `kubeconfig` if it contains multiple entries. Use
[merge-kubeconfigs.sh](https://github.com/gravitational/teleport/blob/master/examples/k8s-auth/merge-kubeconfigs.sh) to combine multiple `kubeconfigs` generated by `get-kubeconfig.sh`.

<Admonition type="warning" title="Warning" >
    When using `kubeconfig_file`, EKS users may need to replace illegal characters in the `context` names.
    Supported characters are alphanumeric characters, `.`, `_`, and `-`. EKS typically includes `:` and `@`
    in their `kubeconfig` which are not allowed in Teleport.
</Admonition>

## Adding kubeconfig to Teleport

In your Teleport Proxy, make sure you have the `kube_listen_addr` and `kube_public_addr` set in the `teleport.yaml` file:

```yaml
# ...
proxy_service:
  # ...
  public_addr: proxy.example.com:3080

  kube_listen_addr: 0.0.0.0:3026
  # optional: set a different public address for kubernetes access
  kube_public_addr: kube.example.com:3026
```

You will also need to include a `kubernetes_service` section in your `teleport.yaml` file. This can be in your existing proxy or a separate Teleport instance:


```yaml
kubernetes_service:
  enabled: yes
  # comment out the following line if this config file specifies a proxy endpoint for the Auth Server (IOT mode):
  listen_addr: 0.0.0.0:3027
  # replace this path with the actual path for your generated kubeconfig
  kubeconfig_file: "path/to/kubeconfig"
```

<Admonition type="warning" title="Warning" >
In EKS `kubeconfig` files, context names typically include the `:` and `@` characters, which are invalid in Teleport. EKS users specifying a `kubeconfig_file` should make sure the file contains only the following characters in `context` names: alphanumeric characters, `.`, `_`, and `-`.
</Admonition>


After Teleport starts with the above config, you should be able to see all new clusters using:

```code
$ tsh kube ls
# or
$ sudo tctl get kube_service
```
