---
title: Manually Upgrade Teleport Cloud Agents on Kubernetes
description: Provides instructions for upgrading Teleport Cloud agents that run on Kubernetes. 
---

This guide explains how to upgrade Teleport Cloud agents running on Kubernetes.

[Automatic updates](./cloud-kubernetes-automatic.mdx) is the recommended update method
for Teleport agents. If you choose to opt out of automatic updates, you will need
to be responsible for keeping your Teleport agents up to date with the version of
Teleport Cloud.

## Prerequisites

- Familiarity with the [Upgrading Compatibility Overview](./overview.mdx) guide,
  which describes the sequence in which to upgrade components of your cluster.

- (!docs/pages/includes/cloud/tctl-tsh-prerequisite.mdx!)

- (!docs/pages/includes/tctl.mdx!)

## Step 1/2. Check for agent updates

The latest compatible Teleport agent version is served by the Teleport Proxy. To
identify what that version is, you can query the `webapi` endpoint.

```code
$ curl https://<Var name="teleport.example.com" />/webapi/automaticupgrades/channel/stable/cloud/version
v15.2.1
```

To list the agents that are upgradable, use the `tctl inventory ls` command to list
the inventory of connected agents. The agents are listed along with their current
version. Additional flags are available to filter by service `--services=node,kube,db,...`,
or to filter by version `--older-than=v15.2.1`.

```code
$ tctl inventory ls --older-than=v15.2.1
Server ID                            Hostname       Services       Version Upgrader
------------------------------------ -------------- -------------- ------- --------
00000000-0000-0000-0000-000000000000 teleport-agent Kube           v14.4.5 none
00000000-0000-0000-0000-000000000001 teleport-proxy Proxy          v15.2.0 none
00000000-0000-0000-0000-000000000002 teleport-auth  Auth,Discovery v15.2.0 none
...
```

Note that the `inventory ls` command will also list `teleport-auth` and `teleport-proxy`
services. These services are managed by the Teleport Cloud team and updates will
be performed automatically.

## Step 2/2. Perform manual updates

[Automatic updates](#automatic-updates) is the recommended update method for Teleport
agents. If you choose to opt out of automatic updates, you will need to be responsible
for keeping your Teleport agents up to date with the version of Teleport Cloud.

(!docs/pages/kubernetes-access/helm/includes/helm-repo-add.mdx!)

Upgrade the Helm release:

```code
$ helm -n <Var name="teleport" /> upgrade <Var name="teleport-agent" /> teleport/teleport-kube-agent \
--values=values.yaml \
--version=<Var name="(=cloud.version=)" />
```
